{"ast":null,"code":"import React,{useState,useCallback}from'react';import{useDropzone}from'react-dropzone';import axios from'axios';import LoadingSpinner from'./LoadingSpinner';import FileInfo from'./FileInfo';import uploadIcon from'../uploadIcon.svg';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const DragAndDropUpload=()=>{const[tags,setTags]=useState([]);const[isUploading,setIsUploading]=useState(false);const[uploadProgress,setUploadProgress]=useState(0);const[fileInfo,setFileInfo]=useState(null);const[ws,setWs]=useState(null);const onDrop=useCallback(acceptedFiles=>{const file=acceptedFiles[0];setFileInfo({name:file.name,size:(file.size/1024/1024).toFixed(2)});const formData=new FormData();formData.append('video',file);setIsUploading(true);axios.post('https://video-metadata-generator.fly.dev/api/upload',formData,{headers:{'Content-Type':'multipart/form-data'}}).then(response=>{const ws=new WebSocket('wss://video-metadata-generator.fly.dev/');setWs(ws);ws.onopen=()=>{ws.send(JSON.stringify({action:'process',filePath:response.data.filePath}));};ws.onmessage=event=>{const data=JSON.parse(event.data);if(data.progress){setUploadProgress(data.progress);}if(data.tags){setTags(data.tags);setIsUploading(false);}if(data.error){console.error(data.error);setIsUploading(false);}};ws.onclose=()=>{setWs(null);};}).catch(error=>{console.error('Error uploading the file:',error);setIsUploading(false);});},[]);const{getRootProps,getInputProps,isDragActive,open}=useDropzone({onDrop,noClick:true,noKeyboard:true,disabled:isUploading,accept:'video/*',maxFiles:1,maxSize:104857600// 100MB\n});return/*#__PURE__*/_jsxs(\"div\",{className:\"flex flex-col items-center max-w-screen-md px-10 py-6 mx-auto md:border-gray-200 md:border md:border-solid md:rounded-md\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"self-start mb-1 text-xl font-bold\",children:\"Upload your Video\"}),/*#__PURE__*/_jsx(\"p\",{className:\"self-start mb-6 text-sm font-semibold text-gray-600\",children:\"Upload a video to generate metadata keywords based on its transcript.\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex flex-col items-center justify-center bg-gray-50 border-gray-400 border-2 rounded-md p-10 mb-6 w-full min-h-60 transition-colors duration-300 \".concat(isDragActive?'bg-indigo-100/50 border-indigo-400 border-solid':'border-gray-400 border-dashed',\" \").concat(isUploading?'opacity-50 cursor-not-allowed':''),...getRootProps(),children:[/*#__PURE__*/_jsx(\"input\",{...getInputProps(),disabled:isUploading}),isUploading?/*#__PURE__*/_jsx(LoadingSpinner,{}):/*#__PURE__*/_jsxs(\"div\",{className:\"flex flex-col items-center\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"w-12 p-2 mb-4 bg-indigo-500 rounded-md\",children:/*#__PURE__*/_jsx(\"img\",{src:uploadIcon,alt:\"A white upload icon - a white arrow pointing up\"})}),/*#__PURE__*/_jsx(\"p\",{className:\"font-bold text-lg text-center transition-opacity opacity-100 \".concat(isDragActive?'opacity-0':'opacity-100'),children:\"\".concat(isDragActive?'Drop to upload your file':'Drag a video file here to upload it')}),/*#__PURE__*/_jsx(\"button\",{type:\"button\",className:\"font-semibold text-indigo-600 hover:cursor-pointer transition-transform transform \".concat(isDragActive?'scale-0':'scale-100'),onClick:open,children:\"Or choose your file\"})]})]}),fileInfo&&/*#__PURE__*/_jsx(FileInfo,{fileInfo:fileInfo,uploadProgress:uploadProgress}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex flex-col w-full\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"mb-1 text-sm uppercase\",children:\"Keywords:\"}),/*#__PURE__*/_jsx(\"ul\",{className:\"flex flex-wrap\",children:tags.map((tag,index)=>/*#__PURE__*/_jsx(\"div\",{className:\"px-3 py-2 mt-2 mr-2 font-semibold rounded-md bg-indigo-50\",children:/*#__PURE__*/_jsx(\"li\",{className:\"inline-block\",children:tag})},index))})]})]});};export default DragAndDropUpload;","map":{"version":3,"names":["React","useState","useCallback","useDropzone","axios","LoadingSpinner","FileInfo","uploadIcon","jsx","_jsx","jsxs","_jsxs","DragAndDropUpload","tags","setTags","isUploading","setIsUploading","uploadProgress","setUploadProgress","fileInfo","setFileInfo","ws","setWs","onDrop","acceptedFiles","file","name","size","toFixed","formData","FormData","append","post","headers","then","response","WebSocket","onopen","send","JSON","stringify","action","filePath","data","onmessage","event","parse","progress","error","console","onclose","catch","getRootProps","getInputProps","isDragActive","open","noClick","noKeyboard","disabled","accept","maxFiles","maxSize","className","children","concat","src","alt","type","onClick","map","tag","index"],"sources":["/Users/brittanycallahan/Documents/Projects/video-metadata-generator/frontend/src/components/DragAndDropUpload.jsx"],"sourcesContent":["import React, { useState, useCallback } from 'react';\nimport { useDropzone } from 'react-dropzone';\nimport axios from 'axios';\nimport LoadingSpinner from './LoadingSpinner';\nimport FileInfo from './FileInfo';\nimport uploadIcon from '../uploadIcon.svg';\n\nconst DragAndDropUpload = () => {\n  const [tags, setTags] = useState([]);\n  const [isUploading, setIsUploading] = useState(false);\n  const [uploadProgress, setUploadProgress] = useState(0);\n  const [fileInfo, setFileInfo] = useState(null);\n  const [ws, setWs] = useState(null);\n\n  const onDrop = useCallback((acceptedFiles) => {\n    const file = acceptedFiles[0];\n    setFileInfo({\n      name: file.name,\n      size: (file.size / 1024 / 1024).toFixed(2),\n    })\n\n    const formData = new FormData();\n    formData.append('video', file);\n\n    setIsUploading(true);\n\n    axios.post('https://video-metadata-generator.fly.dev/api/upload', formData, {\n      headers: {\n        'Content-Type': 'multipart/form-data',\n      },\n    })\n    .then(response => {\n      const ws = new WebSocket('wss://video-metadata-generator.fly.dev/');\n      setWs(ws);\n\n      ws.onopen = () => {\n        ws.send(JSON.stringify({ action: 'process', filePath: response.data.filePath }));\n      }\n\n      ws.onmessage = (event) => {\n        const data = JSON.parse(event.data);\n        if (data.progress) {\n          setUploadProgress(data.progress);\n        }\n        if (data.tags) {\n          setTags(data.tags);\n          setIsUploading(false);\n        }\n        if (data.error) {\n          console.error(data.error);\n          setIsUploading(false);\n        }\n      }\n\n      ws.onclose = () => {\n        setWs(null);\n      }\n    })\n    .catch(error => {\n      console.error('Error uploading the file:', error);\n      setIsUploading(false);\n    })\n  }, []);\n\n  const { getRootProps, getInputProps, isDragActive, open } = useDropzone({ \n    onDrop,\n    noClick: true, \n    noKeyboard: true,\n    disabled: isUploading,\n    accept: 'video/*',\n    maxFiles: 1,\n    maxSize: 104857600, // 100MB\n  });\n\n  return (\n    <div className='flex flex-col items-center max-w-screen-md px-10 py-6 mx-auto md:border-gray-200 md:border md:border-solid md:rounded-md'>\n      <h2 className='self-start mb-1 text-xl font-bold'>Upload your Video</h2>\n      <p className='self-start mb-6 text-sm font-semibold text-gray-600'>Upload a video to generate metadata keywords based on its transcript.</p>\n      <div \n        className={`flex flex-col items-center justify-center bg-gray-50 border-gray-400 border-2 rounded-md p-10 mb-6 w-full min-h-60 transition-colors duration-300 ${isDragActive ? 'bg-indigo-100/50 border-indigo-400 border-solid' : 'border-gray-400 border-dashed'} ${isUploading ? 'opacity-50 cursor-not-allowed' : ''}`} \n        {...getRootProps()}\n      >\n        <input {...getInputProps()} disabled={isUploading} />\n        {\n          isUploading ? (\n            <LoadingSpinner/>\n          ) : (\n            <div className='flex flex-col items-center'>\n              <div className='w-12 p-2 mb-4 bg-indigo-500 rounded-md'>\n                <img src={uploadIcon} alt=\"A white upload icon - a white arrow pointing up\" />\n              </div>\n              <p className={`font-bold text-lg text-center transition-opacity opacity-100 ${isDragActive ? 'opacity-0' : 'opacity-100'}`}>\n                {`${isDragActive ? 'Drop to upload your file' : 'Drag a video file here to upload it'}`}\n              </p>\n              <button type='button'className={`font-semibold text-indigo-600 hover:cursor-pointer transition-transform transform ${isDragActive ? 'scale-0' : 'scale-100'}`} onClick={open}>Or choose your file</button>\n            </div>\n          )\n        }\n      </div>\n      {fileInfo && <FileInfo fileInfo={fileInfo} uploadProgress={uploadProgress} />}\n      <div className='flex flex-col w-full'>\n          <h3 className='mb-1 text-sm uppercase'>Keywords:</h3>\n          <ul className='flex flex-wrap'>\n            {tags.map((tag, index) => (\n              <div key={index} className='px-3 py-2 mt-2 mr-2 font-semibold rounded-md bg-indigo-50'>\n                <li className='inline-block'>{tag}</li>\n              </div>\n            ))}\n          </ul>\n        </div>\n    </div>\n  );\n};\n\nexport default DragAndDropUpload;\n"],"mappings":"AAAA,MAAO,CAAAA,KAAK,EAAIC,QAAQ,CAAEC,WAAW,KAAQ,OAAO,CACpD,OAASC,WAAW,KAAQ,gBAAgB,CAC5C,MAAO,CAAAC,KAAK,KAAM,OAAO,CACzB,MAAO,CAAAC,cAAc,KAAM,kBAAkB,CAC7C,MAAO,CAAAC,QAAQ,KAAM,YAAY,CACjC,MAAO,CAAAC,UAAU,KAAM,mBAAmB,CAAC,OAAAC,GAAA,IAAAC,IAAA,CAAAC,IAAA,IAAAC,KAAA,yBAE3C,KAAM,CAAAC,iBAAiB,CAAGA,CAAA,GAAM,CAC9B,KAAM,CAACC,IAAI,CAAEC,OAAO,CAAC,CAAGb,QAAQ,CAAC,EAAE,CAAC,CACpC,KAAM,CAACc,WAAW,CAAEC,cAAc,CAAC,CAAGf,QAAQ,CAAC,KAAK,CAAC,CACrD,KAAM,CAACgB,cAAc,CAAEC,iBAAiB,CAAC,CAAGjB,QAAQ,CAAC,CAAC,CAAC,CACvD,KAAM,CAACkB,QAAQ,CAAEC,WAAW,CAAC,CAAGnB,QAAQ,CAAC,IAAI,CAAC,CAC9C,KAAM,CAACoB,EAAE,CAAEC,KAAK,CAAC,CAAGrB,QAAQ,CAAC,IAAI,CAAC,CAElC,KAAM,CAAAsB,MAAM,CAAGrB,WAAW,CAAEsB,aAAa,EAAK,CAC5C,KAAM,CAAAC,IAAI,CAAGD,aAAa,CAAC,CAAC,CAAC,CAC7BJ,WAAW,CAAC,CACVM,IAAI,CAAED,IAAI,CAACC,IAAI,CACfC,IAAI,CAAE,CAACF,IAAI,CAACE,IAAI,CAAG,IAAI,CAAG,IAAI,EAAEC,OAAO,CAAC,CAAC,CAC3C,CAAC,CAAC,CAEF,KAAM,CAAAC,QAAQ,CAAG,GAAI,CAAAC,QAAQ,CAAC,CAAC,CAC/BD,QAAQ,CAACE,MAAM,CAAC,OAAO,CAAEN,IAAI,CAAC,CAE9BT,cAAc,CAAC,IAAI,CAAC,CAEpBZ,KAAK,CAAC4B,IAAI,CAAC,qDAAqD,CAAEH,QAAQ,CAAE,CAC1EI,OAAO,CAAE,CACP,cAAc,CAAE,qBAClB,CACF,CAAC,CAAC,CACDC,IAAI,CAACC,QAAQ,EAAI,CAChB,KAAM,CAAAd,EAAE,CAAG,GAAI,CAAAe,SAAS,CAAC,yCAAyC,CAAC,CACnEd,KAAK,CAACD,EAAE,CAAC,CAETA,EAAE,CAACgB,MAAM,CAAG,IAAM,CAChBhB,EAAE,CAACiB,IAAI,CAACC,IAAI,CAACC,SAAS,CAAC,CAAEC,MAAM,CAAE,SAAS,CAAEC,QAAQ,CAAEP,QAAQ,CAACQ,IAAI,CAACD,QAAS,CAAC,CAAC,CAAC,CAClF,CAAC,CAEDrB,EAAE,CAACuB,SAAS,CAAIC,KAAK,EAAK,CACxB,KAAM,CAAAF,IAAI,CAAGJ,IAAI,CAACO,KAAK,CAACD,KAAK,CAACF,IAAI,CAAC,CACnC,GAAIA,IAAI,CAACI,QAAQ,CAAE,CACjB7B,iBAAiB,CAACyB,IAAI,CAACI,QAAQ,CAAC,CAClC,CACA,GAAIJ,IAAI,CAAC9B,IAAI,CAAE,CACbC,OAAO,CAAC6B,IAAI,CAAC9B,IAAI,CAAC,CAClBG,cAAc,CAAC,KAAK,CAAC,CACvB,CACA,GAAI2B,IAAI,CAACK,KAAK,CAAE,CACdC,OAAO,CAACD,KAAK,CAACL,IAAI,CAACK,KAAK,CAAC,CACzBhC,cAAc,CAAC,KAAK,CAAC,CACvB,CACF,CAAC,CAEDK,EAAE,CAAC6B,OAAO,CAAG,IAAM,CACjB5B,KAAK,CAAC,IAAI,CAAC,CACb,CAAC,CACH,CAAC,CAAC,CACD6B,KAAK,CAACH,KAAK,EAAI,CACdC,OAAO,CAACD,KAAK,CAAC,2BAA2B,CAAEA,KAAK,CAAC,CACjDhC,cAAc,CAAC,KAAK,CAAC,CACvB,CAAC,CAAC,CACJ,CAAC,CAAE,EAAE,CAAC,CAEN,KAAM,CAAEoC,YAAY,CAAEC,aAAa,CAAEC,YAAY,CAAEC,IAAK,CAAC,CAAGpD,WAAW,CAAC,CACtEoB,MAAM,CACNiC,OAAO,CAAE,IAAI,CACbC,UAAU,CAAE,IAAI,CAChBC,QAAQ,CAAE3C,WAAW,CACrB4C,MAAM,CAAE,SAAS,CACjBC,QAAQ,CAAE,CAAC,CACXC,OAAO,CAAE,SAAW;AACtB,CAAC,CAAC,CAEF,mBACElD,KAAA,QAAKmD,SAAS,CAAC,0HAA0H,CAAAC,QAAA,eACvItD,IAAA,OAAIqD,SAAS,CAAC,mCAAmC,CAAAC,QAAA,CAAC,mBAAiB,CAAI,CAAC,cACxEtD,IAAA,MAAGqD,SAAS,CAAC,qDAAqD,CAAAC,QAAA,CAAC,uEAAqE,CAAG,CAAC,cAC5IpD,KAAA,QACEmD,SAAS,sJAAAE,MAAA,CAAuJV,YAAY,CAAG,iDAAiD,CAAG,+BAA+B,MAAAU,MAAA,CAAIjD,WAAW,CAAG,+BAA+B,CAAG,EAAE,CAAG,IACvTqC,YAAY,CAAC,CAAC,CAAAW,QAAA,eAElBtD,IAAA,aAAW4C,aAAa,CAAC,CAAC,CAAEK,QAAQ,CAAE3C,WAAY,CAAE,CAAC,CAEnDA,WAAW,cACTN,IAAA,CAACJ,cAAc,GAAC,CAAC,cAEjBM,KAAA,QAAKmD,SAAS,CAAC,4BAA4B,CAAAC,QAAA,eACzCtD,IAAA,QAAKqD,SAAS,CAAC,wCAAwC,CAAAC,QAAA,cACrDtD,IAAA,QAAKwD,GAAG,CAAE1D,UAAW,CAAC2D,GAAG,CAAC,iDAAiD,CAAE,CAAC,CAC3E,CAAC,cACNzD,IAAA,MAAGqD,SAAS,iEAAAE,MAAA,CAAkEV,YAAY,CAAG,WAAW,CAAG,aAAa,CAAG,CAAAS,QAAA,IAAAC,MAAA,CACrHV,YAAY,CAAG,0BAA0B,CAAG,qCAAqC,EACpF,CAAC,cACJ7C,IAAA,WAAQ0D,IAAI,CAAC,QAAQ,CAAAL,SAAS,sFAAAE,MAAA,CAAuFV,YAAY,CAAG,SAAS,CAAG,WAAW,CAAG,CAACc,OAAO,CAAEb,IAAK,CAAAQ,QAAA,CAAC,qBAAmB,CAAQ,CAAC,EACvM,CACN,EAEA,CAAC,CACL5C,QAAQ,eAAIV,IAAA,CAACH,QAAQ,EAACa,QAAQ,CAAEA,QAAS,CAACF,cAAc,CAAEA,cAAe,CAAE,CAAC,cAC7EN,KAAA,QAAKmD,SAAS,CAAC,sBAAsB,CAAAC,QAAA,eACjCtD,IAAA,OAAIqD,SAAS,CAAC,wBAAwB,CAAAC,QAAA,CAAC,WAAS,CAAI,CAAC,cACrDtD,IAAA,OAAIqD,SAAS,CAAC,gBAAgB,CAAAC,QAAA,CAC3BlD,IAAI,CAACwD,GAAG,CAAC,CAACC,GAAG,CAAEC,KAAK,gBACnB9D,IAAA,QAAiBqD,SAAS,CAAC,2DAA2D,CAAAC,QAAA,cACpFtD,IAAA,OAAIqD,SAAS,CAAC,cAAc,CAAAC,QAAA,CAAEO,GAAG,CAAK,CAAC,EAD/BC,KAEL,CACN,CAAC,CACA,CAAC,EACF,CAAC,EACL,CAAC,CAEV,CAAC,CAED,cAAe,CAAA3D,iBAAiB","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}